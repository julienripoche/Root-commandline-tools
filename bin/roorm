#!/usr/bin/python

"""Commandline to remove
objects from ROOT files"""

from cmdLineUtils import *

##### Beginning of the main code #####

# Collect arguments with the module argparse
parser = argparse.ArgumentParser(description="Remove objects from ROOT files")
parser.add_argument("pattern_list", \
                    help="file path and object path in the file : [file_path/]file[.root]:[object_path/]object", \
                    nargs='+')
parser.add_argument("-f", "--force", help="force the removing", action="store_true")
args = parser.parse_args()

# Create a list of tuples that contain a source ROOT file name and a list of path in this file
file_list = [tup for pattern in args.pattern_list for tup in pattern_to_tuple(pattern)]

# Create a dictionnary with options
opt_dict = vars(args)
del opt_dict["pattern_list"]

# Loop on the ROOT files
for file_name, path_list in file_list:
    root_file = ROOT.TFile.Open(file_name,"update")
    for path in path_list:
        deleter(root_file,path,opt_dict)
    root_file.Close()
